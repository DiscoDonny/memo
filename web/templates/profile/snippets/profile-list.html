{{ $settings := .UserSettings }}

<div class="col-md-12">

    <div class="center">
        <form action="profiles" class="form-inline search-form">
            <div class="form-group row">
                <input class="form-control" type="text" name="s" placeholder="Username"
                       value="{{ .SearchString }}"/>
                <input class="btn btn-primary" type="submit" value="Search"/>
            </div>
        </form>
    </div>

{{ if and (eq .NextOffset 25) (lt (len .Profiles) 25) }}<br/>{{ else }}
    <p class="pagination">
        <a class="{{ if eq .NextOffset 25 }}disabled{{ end }}"
           href="{{ .OffsetLink }}&offset={{ .PrevOffset }}">&lt; {{ T "previous" }}</a>
        <span class="page">{{ .Page }}</span>
        <a class="{{ if lt (len .Profiles) 25 }}disabled{{ end }}"
           href="{{ .OffsetLink }}&offset={{ .NextOffset }}">{{ T "next" }}
            &gt;</a>
    </p>
{{ end }}

    <div id="profile-list">
        <table class="table table-striped table-condensed">
            <thead>
            <tr>
                <th style="width:50%">User</th>
                <th>Actions</th>
                <th>Followers</th>
                <th>Created</th>
                <th>Last Action</th>
            </tr>
            </thead>
            <tbody>
            {{ range .Profiles }}
            <tr>
                <td>
                {{ if .NameSet }}
                    <span data-address="{{ .Name }} {{ .GetAddressString }}">
                    {{ if .Pic }}
                        <img class="profile-pic profile-pic-24"
                             src="/img/profilepics/{{ .GetAddressString }}-24x24.{{ .Pic.GetExtension }}?id={{ .Pic.Id }}"/>
                    {{ else }}
                        <span class="identicon-{{ .GetAddressString }}">
                            <img class="identicon"/>
                        </span>
                    {{ end }}
                        <a href="/profile/{{ .GetAddressString }}">{{ .Name }} ({{ .GetAddressString }})</a>
                    </span>
                {{ else }}
                    <span data-address="{{ .GetAddressString }}">
                    {{ if .Pic }}
                        <img class="profile-pic profile-pic-24"
                             src="/img/profilepics/{{ .GetAddressString }}-24x24.{{ .Pic.GetExtension }}?id={{ .Pic.Id }}"/>
                    {{ else }}
                        <span class="identicon-{{ .GetAddressString }}">
                            <img class="identicon"/>
                        </span>
                    {{ end }}
                        <a href="/profile/{{ .GetAddressString }}">{{ .GetAddressString }}</a>
                    </span>
                {{ end }}
                    <script type="text/javascript">
                        (function () {
                            var foreground = {{ if eq $settings.Theme "dark" }}[224, 224, 224, 255]{{ else }}[180, 180, 180, 255]{{ end }};
                            var background = [0, 0, 0, 0];
                            var data = new Identicon('{{ .GetAddressString }}', {
                                foreground: foreground,
                                background: background,
                                size: 24,
                                form: 'svg',
                                margin: 0
                            }).toString();
                            $(".identicon-{{ .GetAddressString }}").html('<img class="identicon" src="data:image/png;base64,' + data + '">');
                        })();
                    </script>
                </td>
                <td>{{ .NumPosts }}</td>
                <td>{{ .FollowerCount }}</td>
                <td>{{ .FirstPost.Format "2006-01-02 15:04" }}</td>
                <td>{{ .LastPost.Format "2006-01-02 15:04" }}</td>
            </tr>

            {{ end }}
            </tbody>
        </table>
    </div>

{{ if and (eq .NextOffset 25) (lt (len .Profiles) 25) }}<br/>{{ else }}
    <p class="pagination">
        <a class="{{ if eq .NextOffset 25 }}disabled{{ end }}"
           href="{{ .OffsetLink }}&offset={{ .PrevOffset }}">&lt; {{ T "previous" }}</a>
        <span class="page">{{ .Page }}</span>
        <a class="{{ if lt (len .Profiles) 25 }}disabled{{ end }}"
           href="{{ .OffsetLink }}&offset={{ .NextOffset }}">{{ T "next" }}
            &gt;</a>
    </p>
{{ end }}
</div>
